let loadedJSONLayer = null;

function addOpenStreetMaps(map) {
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19}).addTo(map);
}

function onEachFeature(feature, layer) {
    if (feature.properties && feature.properties.direction) {
        console.log(feature.properties.direction + ' on ' + feature.properties.street_name + " (" + feature.properties.angle_diff + "°)");
        layer.bindPopup(feature.properties.direction + ' on ' + feature.properties.street_name + " (" + feature.properties.angle_diff + "°)");
    }
}

function loadJSON(map, json) {
    if (loadedJSONLayer) {
        map.removeLayer(loadedJSONLayer);
    }

    loadedJSONLayer = L.geoJSON(json, {
        onEachFeature: onEachFeature
    });
    loadedJSONLayer.addTo(map)

    zoomToData(map, loadedJSONLayer);
}

function zoomToData(map, data) {
    const bounds = data.getBounds();
    map.fitBounds(bounds);
}

var map = L.map('map')
addOpenStreetMaps(map);
loadJSON(map,
    {"type" : "FeatureCollection", "features" : [{"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4882036,51.2308615],[5.4865927,51.2299434]]]}, "properties" : {"gid" : 404250, "street_name" : "Erkestraat", "current_angle" : 240.319893450049, "prev_angle" : null, "direction" : null, "angle_diff" : null}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4865927,51.2299434],[5.4865162,51.2299764],[5.486401,51.2300393],[5.4860378,51.2302531]]]}, "properties" : {"gid" : 421416, "street_name" : "Broekkant", "current_angle" : 293.334041271871, "prev_angle" : 240.319893450049, "direction" : "Turn Right", "angle_diff" : 53.014147821822}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4860378,51.2302531],[5.4856764,51.2305447]]]}, "properties" : {"gid" : 414137, "street_name" : "Broekkant", "current_angle" : 308.898748036664, "prev_angle" : 300.483466219917, "direction" : "Go Straight", "angle_diff" : 8.415281816747}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4856764,51.2305447],[5.4849458,51.2311097],[5.4846777,51.2312733],[5.484561,51.2313262],[5.4844794,51.2313386],[5.4843706,51.2313571],[5.4840408,51.2313613]]]}, "properties" : {"gid" : 404394, "street_name" : "Broekkant", "current_angle" : 307.716107209725, "prev_angle" : 308.898748036664, "direction" : "Go Straight", "angle_diff" : -1.182640826939}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4840408,51.2313613],[5.4840313,51.2312807],[5.4839221,51.2309782],[5.483805,51.2307158],[5.4834078,51.2296744],[5.4833325,51.2294771],[5.4832693,51.2293129],[5.4832241,51.2291956],[5.4832111,51.2291618]]]}, "properties" : {"gid" : 618117, "street_name" : "Venderstraat", "current_angle" : 186.722209927143, "prev_angle" : 270.729621790395, "direction" : "Turn Left", "angle_diff" : -84.007411863252}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4832111,51.2291618],[5.4831861,51.2290626]]]}, "properties" : {"gid" : 415646, "street_name" : "Venderstraat", "current_angle" : 194.144912431362, "prev_angle" : 201.037511031072, "direction" : "Go Straight", "angle_diff" : -6.892598599710}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4831861,51.2290626],[5.4831095,51.2289928],[5.4828037,51.2283196],[5.4826252,51.2279801],[5.4822157,51.2273541]]]}, "properties" : {"gid" : 415633, "street_name" : "Venderstraat", "current_angle" : 227.659368013661, "prev_angle" : 194.144912431362, "direction" : "Go Straight", "angle_diff" : 33.514455582299}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4822157,51.2273541],[5.4821706,51.227368],[5.4821223,51.2273765],[5.4820724,51.2273798],[5.4820224,51.2273775],[5.4819737,51.2273699],[5.4819278,51.227357],[5.4818863,51.2273394],[5.4818501,51.2273174],[5.4818232,51.2272987]]]}, "properties" : {"gid" : 426164, "street_name" : "Venderstraat", "current_angle" : 287.12950686781, "prev_angle" : 213.190839960391, "direction" : "Turn Right", "angle_diff" : 73.938666907419}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4818232,51.2272987],[5.4818049,51.2272763],[5.4817907,51.2272506]]]}, "properties" : {"gid" : 423167, "street_name" : "Venderstraat", "current_angle" : 219.247595308663, "prev_angle" : 235.194236997424, "direction" : "Go Straight", "angle_diff" : -15.946641688761}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4817907,51.2272506],[5.4814816,51.2273297],[5.481312,51.2273673]]]}, "properties" : {"gid" : 617931, "street_name" : "Jos Verlindenstraat", "current_angle" : 284.354187137763, "prev_angle" : 208.921931346119, "direction" : "Turn Right", "angle_diff" : 75.432255791644}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.481312,51.2273673],[5.4774262,51.2282545],[5.4772263,51.2282814],[5.476859,51.2283351],[5.4762041,51.228438]]]}, "properties" : {"gid" : 407867, "street_name" : "Jos Verlindenstraat", "current_angle" : 282.861228208712, "prev_angle" : 282.500188440711, "direction" : "Go Straight", "angle_diff" : 0.361039768001}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4762041,51.228438],[5.4705288,51.2292994]]]}, "properties" : {"gid" : 409614, "street_name" : "Jos Verlindenstraat", "current_angle" : 278.630511026422, "prev_angle" : 278.929492360483, "direction" : "Go Straight", "angle_diff" : -0.298981334061}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4705288,51.2292994],[5.4669861,51.2298372],[5.4668507,51.22985],[5.4667204,51.2298625],[5.4666221,51.2298591]]]}, "properties" : {"gid" : 618106, "street_name" : "Jos Verlindenstraat", "current_angle" : 278.631888633366, "prev_angle" : 278.630511026422, "direction" : "Go Straight", "angle_diff" : 0.001377606944}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4666221,51.2298591],[5.46335,51.2295936]]]}, "properties" : {"gid" : 404408, "street_name" : "Jos Verlindenstraat", "current_angle" : 265.361151414813, "prev_angle" : 268.019043515864, "direction" : "Go Straight", "angle_diff" : -2.657892101051}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.46335,51.2295936],[5.4609744,51.229421],[5.4605401,51.2294089],[5.4602813,51.229418],[5.4599829,51.2294527],[5.4597249,51.2294984],[5.4595027,51.2295587]]]}, "properties" : {"gid" : 404407, "street_name" : "Sint-Antoniusweg", "current_angle" : 265.84445810134, "prev_angle" : 265.361151414813, "direction" : "Go Straight", "angle_diff" : 0.483306686527}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4595027,51.2295587],[5.4593952,51.2295951],[5.4591065,51.2297028]]]}, "properties" : {"gid" : 404224, "street_name" : "Sint-Antoniusweg", "current_angle" : 288.706339451643, "prev_angle" : 285.183092505449, "direction" : "Go Straight", "angle_diff" : 3.523246946194}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4591065,51.2297028],[5.4570978,51.230454],[5.456654,51.230589],[5.4564412,51.2306599],[5.4562645,51.2307213],[5.4560082,51.2308018],[5.4553871,51.23098],[5.4552896,51.2310084]]]}, "properties" : {"gid" : 617711, "street_name" : "Sint-Antoniusweg", "current_angle" : 290.504450514267, "prev_angle" : 290.458111251687, "direction" : "Go Straight", "angle_diff" : 0.046339262580}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4552896,51.2310084],[5.4551631,51.2310419],[5.4550185,51.2310823],[5.4545953,51.2311797],[5.4544169,51.2312235],[5.4541606,51.2312843],[5.4538897,51.2313317],[5.4535117,51.2313936],[5.4532267,51.2314502],[5.4529626,51.2314841]]]}, "properties" : {"gid" : 407334, "street_name" : "Sint-Antoniusweg", "current_angle" : 284.832704389865, "prev_angle" : 286.239893457619, "direction" : "Go Straight", "angle_diff" : -1.407189067754}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4529626,51.2314841],[5.4526986,51.2315224],[5.4524343,51.2315473],[5.4521127,51.2315728],[5.450868,51.2316111]]]}, "properties" : {"gid" : 404070, "street_name" : "Sint-Antoniusweg", "current_angle" : 278.25463839082, "prev_angle" : 277.314515838138, "direction" : "Go Straight", "angle_diff" : 0.940122552682}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.450868,51.2316111],[5.4497144,51.2316342],[5.4490161,51.2316621],[5.4484522,51.2316794],[5.4477261,51.2316885]]]}, "properties" : {"gid" : 407101, "street_name" : "Sint-Antoniusweg", "current_angle" : 271.147152955708, "prev_angle" : 271.762461774822, "direction" : "Go Straight", "angle_diff" : -0.615308819114}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4477261,51.2316885],[5.4474292,51.2316877],[5.447178,51.2316834],[5.4469669,51.2316856],[5.4450348,51.2316072]]]}, "properties" : {"gid" : 406898, "street_name" : "Sint-Antoniusweg", "current_angle" : 269.845616327374, "prev_angle" : 270.718033739169, "direction" : "Go Straight", "angle_diff" : -0.872417411795}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4450348,51.2316072],[5.4448834,51.2315332],[5.4442183,51.2311852]]]}, "properties" : {"gid" : 406890, "street_name" : "Sint-Antoniusweg", "current_angle" : 243.951934926317, "prev_angle" : 267.676348983118, "direction" : "Go Straight", "angle_diff" : -23.724414056801}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4442183,51.2311852],[5.444063,51.231102],[5.4435128,51.2308285],[5.4432593,51.2307213],[5.4432152,51.2307105],[5.443174,51.2307145],[5.4431332,51.230727]]]}, "properties" : {"gid" : 407544, "street_name" : "Sint-Antoniusweg", "current_angle" : 241.820386093754, "prev_angle" : 242.380104612124, "direction" : "Go Straight", "angle_diff" : -0.559718518370}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4431332,51.230727],[5.442916,51.2305969],[5.4428427,51.2305476],[5.4426433,51.2304623],[5.4424923,51.2303855],[5.4424248,51.2303685]]]}, "properties" : {"gid" : 615810, "street_name" : "Hamonterweg", "current_angle" : 239.078934889812, "prev_angle" : 287.033626585485, "direction" : "Turn Left", "angle_diff" : -47.954691695673}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4424248,51.2303685],[5.4422569,51.2302726],[5.4419713,51.2301301],[5.4416691,51.230005],[5.4413932,51.2299052],[5.4413309,51.229885],[5.441177,51.2298426]]]}, "properties" : {"gid" : 403962, "street_name" : "Heerstraat", "current_angle" : 240.26614489759, "prev_angle" : 255.863938202105, "direction" : "Go Straight", "angle_diff" : -15.597793304515}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.441177,51.2298426],[5.4410709,51.2298227],[5.4408478,51.229783]]]}, "properties" : {"gid" : 403958, "street_name" : "Heerstraat", "current_angle" : 259.377084281365, "prev_angle" : 254.596928124295, "direction" : "Go Straight", "angle_diff" : 4.780156157070}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4408478,51.229783],[5.4406682,51.2297565],[5.4404566,51.2297384],[5.4401462,51.229707],[5.4398687,51.2296823],[5.4394998,51.2296526],[5.4392224,51.2296343]]]}, "properties" : {"gid" : 403936, "street_name" : "Heerstraat", "current_angle" : 261.606562974567, "prev_angle" : 259.909997562379, "direction" : "Go Straight", "angle_diff" : 1.696565412188}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4392224,51.2296343],[5.4387224,51.2295901],[5.4386403,51.2295828],[5.438375,51.2295624]]]}, "properties" : {"gid" : 616649, "street_name" : "Heerstraat", "current_angle" : 264.948185017717, "prev_angle" : 266.22568247756, "direction" : "Go Straight", "angle_diff" : -1.277497459843}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.438375,51.2295624],[5.4375003,51.2294928]]]}, "properties" : {"gid" : 404100, "street_name" : "Heerstraat", "current_angle" : 265.450552209531, "prev_angle" : 265.602946152561, "direction" : "Go Straight", "angle_diff" : -0.152393943030}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4375003,51.2294928],[5.4374056,51.2294833],[5.4372479,51.2294618],[5.43715,51.2294433],[5.4370834,51.2294354],[5.4369845,51.2294132],[5.4369223,51.2293999],[5.4368197,51.2293708],[5.4366114,51.2292957]]]}, "properties" : {"gid" : 410534, "street_name" : "Heerstraat", "current_angle" : 264.271436412395, "prev_angle" : 265.450552209531, "direction" : "Go Straight", "angle_diff" : -1.179115797136}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4366114,51.2292957],[5.4365514,51.2292684],[5.4364892,51.2292425],[5.4363274,51.2291658],[5.4361711,51.2290862],[5.4359609,51.2289945],[5.4358099,51.2289319]]]}, "properties" : {"gid" : 416820, "street_name" : "Heerstraat", "current_angle" : 245.534464889084, "prev_angle" : 250.173855711382, "direction" : "Go Straight", "angle_diff" : -4.639390822298}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4358099,51.2289319],[5.435501,51.2288207],[5.4353055,51.2287576]]]}, "properties" : {"gid" : 403917, "street_name" : "Heerstraat", "current_angle" : 250.20178045875, "prev_angle" : 247.482593277352, "direction" : "Go Straight", "angle_diff" : 2.719187181398}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4353055,51.2287576],[5.4352311,51.2288297],[5.4350398,51.2289272],[5.434852,51.2290178],[5.4347074,51.2290806],[5.4346278,51.2291086],[5.4345745,51.2291202]]]}, "properties" : {"gid" : 422185, "street_name" : "Korte Heerstraat", "current_angle" : 314.10054971084, "prev_angle" : 252.111884686094, "direction" : "Turn Right", "angle_diff" : 61.988665024746}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4345745,51.2291202],[5.4345625,51.2291228],[5.4345152,51.2291255],[5.4344129,51.229117],[5.4343763,51.229108],[5.4343176,51.2290879],[5.4338183,51.2288966]]]}, "properties" : {"gid" : 403906, "street_name" : "Korte Heerstraat", "current_angle" : 282.225122686537, "prev_angle" : 282.278161626921, "direction" : "Go Straight", "angle_diff" : -0.053038940384}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4338183,51.2288966],[5.4332802,51.2295369]]]}, "properties" : {"gid" : 403901, "street_name" : "Groenstraat", "current_angle" : 319.95673212149, "prev_angle" : 249.036345511858, "direction" : "Turn Right", "angle_diff" : 70.920386609632}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4332802,51.2295369],[5.4332245,51.2295796]]]}, "properties" : {"gid" : 410765, "street_name" : "Norbertinessenlaan", "current_angle" : 307.474019985204, "prev_angle" : 319.95673212149, "direction" : "Go Straight", "angle_diff" : -12.482712136286}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4332245,51.2295796],[5.4330985,51.2296184],[5.4328035,51.2298179]]]}, "properties" : {"gid" : 403800, "street_name" : "Norbertinessenlaan", "current_angle" : 287.11550964609, "prev_angle" : 307.474019985204, "direction" : "Go Straight", "angle_diff" : -20.358510339114}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4328035,51.2298179],[5.4324689,51.2301071]]]}, "properties" : {"gid" : 409570, "street_name" : "Norbertinessenlaan", "current_angle" : 310.837367546727, "prev_angle" : 304.069356475983, "direction" : "Go Straight", "angle_diff" : 6.768011070744}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4324689,51.2301071],[5.4318003,51.2306853],[5.4317539,51.2307314]]]}, "properties" : {"gid" : 409571, "street_name" : "Norbertinessenlaan", "current_angle" : 310.85299117608, "prev_angle" : 310.837367546727, "direction" : "Go Straight", "angle_diff" : 0.015623629353}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4317539,51.2307314],[5.4316848,51.2307479],[5.4316304,51.230762],[5.4316232,51.2307644],[5.4315908,51.2307806],[5.4315404,51.2308199]]]}, "properties" : {"gid" : 403881, "street_name" : null, "current_angle" : 283.429858059396, "prev_angle" : 314.814176504008, "direction" : "Go Straight", "angle_diff" : -31.384318444612}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4315404,51.2308199],[5.430885,51.2306617]]]}, "properties" : {"gid" : 403875, "street_name" : "Onderwijslaan", "current_angle" : 256.429565614717, "prev_angle" : 307.94574826523, "direction" : "Turn Left", "angle_diff" : -51.516182650513}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.430885,51.2306617],[5.430295,51.2304962]]]}, "properties" : {"gid" : 403867, "street_name" : "Onderwijslaan", "current_angle" : 254.33074167395, "prev_angle" : 256.429565614717, "direction" : "Go Straight", "angle_diff" : -2.098823940767}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.430295,51.2304962],[5.4294996,51.2302634]]]}, "properties" : {"gid" : 406291, "street_name" : "Onderwijslaan", "current_angle" : 253.68614757382, "prev_angle" : 254.33074167395, "direction" : "Go Straight", "angle_diff" : -0.64459410013}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4294996,51.2302634],[5.4293368,51.2305119],[5.4291659,51.2307283],[5.4289661,51.2309587],[5.4288772,51.2310738],[5.4287775,51.2311959],[5.428639,51.2313892],[5.4285468,51.2315296]]]}, "properties" : {"gid" : 403846, "street_name" : "Broesveldstraat", "current_angle" : 326.76995779055, "prev_angle" : 253.68614757382, "direction" : "Turn Right", "angle_diff" : 73.08381021673}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4285468,51.2315296],[5.428476,51.2316376],[5.4283988,51.2317939],[5.4283677,51.2318997]]]}, "properties" : {"gid" : 410505, "street_name" : "Broesveldstraat", "current_angle" : 326.752932251484, "prev_angle" : 326.707287851006, "direction" : "Go Straight", "angle_diff" : 0.045644400478}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4283677,51.2318997],[5.4282888,51.2319503],[5.4281837,51.2320083],[5.4280593,51.2320775]]]}, "properties" : {"gid" : 410507, "street_name" : "Sint-Martensstraat", "current_angle" : 302.672788587393, "prev_angle" : 343.619255909566, "direction" : "Go Straight", "angle_diff" : -40.946467322173}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4280593,51.2320775],[5.4280081,51.2320982],[5.4279556,51.2321259],[5.4279089,51.2321565]]]}, "properties" : {"gid" : 408941, "street_name" : "Sint-Martensstraat", "current_angle" : 292.013329694759, "prev_angle" : 299.085879087376, "direction" : "Go Straight", "angle_diff" : -7.072549392617}}, {"type" : "Feature", "geometry" : {"type":"MultiLineString","coordinates":[[[5.4279089,51.2321565],[5.4278415,51.2322007],[5.4277489,51.2322551]]]}, "properties" : {"gid" : 422601, "street_name" : "Sint-Martensstraat", "current_angle" : 303.256315608753, "prev_angle" : 303.234671022159, "direction" : "Go Straight", "angle_diff" : 0.021644586594}}]}
)